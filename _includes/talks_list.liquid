<div class="publications">
  {% assign talks = site.talks | sort: 'date' | reverse %}
  {% if talks and talks.size > 0 %}
    {% assign current_year = '' %}
    {% for talk in talks %}
      {% assign talk_year = talk.date | date: '%Y' %}
      {% if talk_year != current_year %}
        {% unless forloop.first %}<br>{% endunless %}
        <h2 class="bibliography">{{ talk_year }}</h2>
        {% assign current_year = talk_year %}
      {% endif %}
      <div class="row mb-3">
        {% if site.enable_publication_thumbnails %}
          <div class="col col-sm-2 abbr">
            {% if talk.preview %}
              {% if talk.preview contains '://' %}
                <img class="preview z-depth-1 rounded" src="{{ talk.preview }}" alt="{{ talk.title }} preview">
              {% else %}
                {% assign path = talk.preview | prepend: '/assets/img/talks/' %}
                {% include figure.liquid loading="eager" path=path sizes="200px" class="preview z-depth-1 rounded" zoomable=true avoid_scaling=true alt=talk.title %}
              {% endif %}
            {% endif %}
          </div>
        {% endif %}

        <div class="{% if site.enable_publication_thumbnails %}col-sm-8{% else %}col-sm-10{% endif %}">
          <div class="title">
            {% if talk.announcement %}
              <a href="{{ talk.announcement }}">{{ talk.title }}</a>
            {% elsif talk.website %}
              <a href="{{ talk.website }}">{{ talk.title }}</a>
            {% else %}
              {{ talk.title }}
            {% endif %}
          </div>
          <div class="periodical">
            {% if talk.event %}<em>{{ talk.event }}</em>{% endif %}
            {% if talk.location %}{% if talk.event %}, {% endif %}{{ talk.location }}{% endif %}
            {% if talk.date %}{% if talk.event or talk.location %}, {% endif %}{{ talk.date | date: '%b %d, %Y' }}{% endif %}
          </div>
          {% if talk.description %}
            <div class="periodical">{{ talk.description }}</div>
          {% endif %}

          <div class="links">
            {% if talk.announcement %}
              <a href="{{ talk.announcement }}" class="btn btn-sm z-depth-0" role="button">Announcement</a>
            {% endif %}
            {% if talk.paper %}
              {% if talk.paper contains '://' %}
                <a href="{{ talk.paper }}" class="btn btn-sm z-depth-0" role="button">Paper</a>
              {% else %}
                <a href="{{ talk.paper | prepend: '/assets/pdf/' | relative_url }}" class="btn btn-sm z-depth-0" role="button">Paper</a>
              {% endif %}
            {% endif %}
            {% if talk.slides %}
              {% if talk.slides contains '://' %}
                <a href="{{ talk.slides }}" class="btn btn-sm z-depth-0" role="button">Slides</a>
              {% else %}
                <a href="{{ talk.slides | prepend: '/assets/pdf/' | relative_url }}" class="btn btn-sm z-depth-0" role="button">Slides</a>
              {% endif %}
            {% endif %}
            {% if talk.video %}
              <a href="{{ talk.video }}" class="btn btn-sm z-depth-0" role="button">Video</a>
            {% endif %}
            {% if talk.website %}
              <a href="{{ talk.website }}" class="btn btn-sm z-depth-0" role="button">Website</a>
            {% endif %}
          </div>
        </div>
      </div>
    {% endfor %}
  {% else %}
    <p>No talks yet.</p>
  {% endif %}
</div>
